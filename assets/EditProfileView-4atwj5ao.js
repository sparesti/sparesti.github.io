import{_ as C,o as r,c as i,a as t,t as c,K as I,f as d,u as U,r as z,b as g,w as P,e as o,q as B,i as k}from"./index-CWVWdIaL.js";import{N as D}from"./NavBar-B2MYh0mE.js";/* empty css                  */import{u as R,a as N,c as w,F as q}from"./index.esm-BQ7r5GQE.js";import{u as V}from"./token-Cfw4qG7q.js";import{a as x}from"./axios-Cm0UX6qg.js";import{n as A}from"./httputils-0tl6qC22.js";import{E as K}from"./EditKnowlegde-BroK5FnB.js";const Z={class:"element"},M={class:"heading"},T=["value"],j={key:0,class:"error"},G={__name:"EditInputElement",props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""},error:String},emits:["update:modelValue"],setup(u,{emit:b}){const l=b,_=m=>{l("update:modelValue",m.target.value)};return(m,y)=>(r(),i("div",Z,[t("label",M,c(u.label),1),t("input",{class:I(["inputField",{"is-error":u.error}]),value:u.modelValue,onInput:_,name:"inputField",minlength:"2",maxlength:"30"},null,42,T),u.error?(r(),i("span",j,c(u.error),1)):d("",!0)]))}},E=C(G,[["__scopeId","data-v-d0972c04"]]),H={class:"flex-container"},J=t("div",{class:"header"},[t("h1",{class:"title"},"Rediger profil")],-1),O={class:"main",id:"profile"},Q={class:"centered-content"},W={key:0,class:"error"},X={key:1,class:"error"},Y={key:2,class:"error"},ee=t("br",null,null,-1),te=t("br",null,null,-1),se=t("h3",null,"Kunnskapsnivå",-1),oe=t("br",null,null,-1),ae=t("br",null,null,-1),le={key:1,class:"error"},re=["disabled"],ne=t("br",null,null,-1),ie=t("br",null,null,-1),ue={class:"footer"},he={__name:"EditProfileView",setup(u){const{handleSubmit:b,errors:l,meta:_}=R(),m=U(),y=/^[A-Za-z\s-]+$/,L=/^[a-zA-Z0-9._%+-æøåÆØÅ]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,h=z(""),F=V(),{value:p}=N("firstName",w().required("Fornavn må fylles ut").matches(y,"Fornavn kan bare inneholde bokstaver")),{value:f}=N("lastName",w().required("Etternavn må fylles ut").matches(y,"Etternavn kan bare inneholde bokstaver")),{value:v}=N("email",w().required("Epost må fylles ut").matches(L,"Må være en gyldig epost"));let n="";(async()=>{try{const a=V(),e=await x.get("http://localhost:8080/api/users/"+a.getLoggedInUser(),a.getAxiosAuthorizationConfig());if(e.status===200){const s=e.data;p.value=s.firstName,f.value=s.lastName,v.value=s.email,n=s.knowledgeLevel}else await m.push("/login")}catch(a){console.error("Error fetching data:",a)}})();const S=async()=>{try{const a=V(),e={firstName:p.value,lastName:f.value,email:v.value,knowledgeLevel:n};(await x.put("http://localhost:8080/api/users/"+a.getLoggedInUser(),e,a.getAxiosAuthorizationConfig())).status===200?await A("/profile"):console.error("Feil ved oppdatering av profil")}catch(a){a.response&&a.response.status===409&&(console.error("Mail already registered"),h.value="Eposten er allerede registrert"),console.error("Feil ved oppdatering av profil:",a)}},$=async()=>{if(confirm("Er du sikker på at du vil slette brukeren?"))try{const e=await x.delete("http://localhost:8080/api/users/"+F.getLoggedInUser(),F.getAxiosAuthorizationConfig());console.log(e.data),await m.push("/")}catch(e){e.response&&e.response.status===404&&(console.error("User not found"),h.value="Noe gikk galt"),console.error("Login failed:",e)}};return(a,e)=>(r(),i("div",H,[J,t("div",O,[t("div",Q,[g(o(q),{onSubmit:e[3]||(e[3]=s=>o(b)(S))},{default:P(()=>[o(l).firstName?(r(),i("span",W,c(o(l).firstName),1)):d("",!0),g(E,{label:"Fornavn",type:"text",modelValue:o(p),"onUpdate:modelValue":e[0]||(e[0]=s=>k(p)?p.value=s:null),name:"firstName"},null,8,["modelValue"]),o(l).lastName?(r(),i("span",X,c(o(l).lastName),1)):d("",!0),g(E,{label:"Etternavn",type:"text",modelValue:o(f),"onUpdate:modelValue":e[1]||(e[1]=s=>k(f)?f.value=s:null),name:"lastName"},null,8,["modelValue"]),o(l).email?(r(),i("span",Y,c(o(l).email),1)):d("",!0),g(E,{label:"Email",type:"text",modelValue:o(v),"onUpdate:modelValue":e[2]||(e[2]=s=>k(v)?v.value=s:null),name:"email"},null,8,["modelValue"])]),_:1}),t("button",{class:"btn",id:"changePassword",onClick:e[4]||(e[4]=s=>o(A)("/editPassword"))},"Endre passord"),ee,te,se,o(n)!==""?(r(),B(K,{key:0,knowledgeLevel:o(n),onKnowledge:e[5]||(e[5]=s=>k(n)?n.value=s:n=s)},null,8,["knowledgeLevel"])):d("",!0),oe,ae,h.value?(r(),i("div",le,c(h.value),1)):d("",!0),t("button",{class:"btn",id:"edit",onClick:S,disabled:!o(_).valid||!o(_).dirty},"Lagre",8,re),ne,ie,t("button",{class:"btn",id:"delete",onClick:$},"Slett bruker")])]),t("div",ue,[g(D)])]))}};export{he as default};
