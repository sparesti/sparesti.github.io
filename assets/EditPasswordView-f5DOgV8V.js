import{_ as C,o as n,c as i,a as o,t as m,K as E,f as _,u as L,r as c,b as f,w as B,e as t,i as V}from"./index-CWVWdIaL.js";import{N as U}from"./NavBar-B2MYh0mE.js";/* empty css                  */import{u as N}from"./token-Cfw4qG7q.js";import{a as x}from"./axios-Cm0UX6qg.js";import{n as F}from"./httputils-0tl6qC22.js";import{u as A,a as S,c as I,F as z}from"./index.esm-BQ7r5GQE.js";const D={class:"element"},R={class:"heading"},q=["value"],T={key:0,class:"error"},K={__name:"EditPasswordInputElement",props:{label:{type:String,default:""},modelValue:{type:[String,Number],default:""},error:String},emits:["update:modelValue"],setup(r,{emit:g}){const h=g,l=d=>{h("update:modelValue",d.target.value)};return(d,w)=>(n(),i("div",D,[o("label",R,m(r.label),1),o("input",{class:E(["inputField",{"is-error":r.error}]),value:r.modelValue,onInput:l,name:"inputField",minlength:"2",maxlength:"30",type:"password"},null,42,q),r.error?(n(),i("span",T,m(r.error),1)):_("",!0)]))}},$=C(K,[["__scopeId","data-v-d6a76940"]]),j={class:"flex-container"},G=o("div",{class:"header"},[o("h1",{class:"title"},"Rediger passord")],-1),H={class:"main",id:"profile"},J={key:0,class:"error"},M={key:1,class:"error"},O={key:2,class:"error"},Q=o("br",null,null,-1),W=["disabled"],X=o("br",null,null,-1),Y=o("br",null,null,-1),Z={class:"footer"},ne={__name:"EditPasswordView",setup(r){const g=L(),{handleSubmit:h,errors:l,meta:d}=A(),w=c(""),b=c(""),P=c(""),p=c(""),k=c(""),{value:u}=S("password",I().required("Passord må oppgis")),{value:v}=S("confirmPassword",I().required("Passord må oppgis"));(async()=>{try{const s=N();await F("/editPassword");const e=await x.get("http://localhost:8080/api/users/"+s.getLoggedInUser(),s.getAxiosAuthorizationConfig());if(e.status===200){const a=e.data;w.value=a.firstName,b.value=a.lastName,P.value=a.email,k.value=a.knowledgeLevel}else await g.push("/login")}catch(s){console.error("Error fetching data:",s)}})();const y=async()=>{if(u.value!==v.value){p.value="Passordene matcher ikke",console.error(p.value);return}try{const s=N(),e={firstName:w.value,lastName:b.value,email:P.value,knowledgeLevel:k.value,password:u.value};(await x.put("http://localhost:8080/api/users/"+s.getLoggedInUser(),e,s.getAxiosAuthorizationConfig())).status===200?(alert("Passordet ditt har blitt endret."),await F("/editProfile")):alert("Feil ved endring av passord")}catch(s){console.error("Feil ved endring av passord:",s),alert("Feil ved endring av passord")}};return(s,e)=>(n(),i("div",j,[G,o("div",H,[f(t(z),{onSubmit:e[2]||(e[2]=a=>t(h)(y))},{default:B(()=>[t(l).password?(n(),i("span",J,m(t(l).password),1)):_("",!0),f($,{label:"Nytt passord",modelValue:t(u),"onUpdate:modelValue":e[0]||(e[0]=a=>V(u)?u.value=a:null),name:"password"},null,8,["modelValue"]),t(l).confirmPassword?(n(),i("span",M,m(t(l).confirmPassword),1)):_("",!0),f($,{label:"Bekreft nytt passord",modelValue:t(v),"onUpdate:modelValue":e[1]||(e[1]=a=>V(v)?v.value=a:null),name:"confirmPassword"},null,8,["modelValue"]),p.value?(n(),i("div",O,m(p.value),1)):_("",!0),Q]),_:1}),o("button",{class:"btn",id:"changePassword",onClick:y,disabled:!t(d).valid||!t(d).dirty},"Lagre",8,W),X,Y]),o("div",Z,[f(U)])]))}};export{ne as default};
