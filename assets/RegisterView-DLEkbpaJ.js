import{_ as R,r as P,c as o,b as S,w as I,e,o as r,a as l,t as i,f as u,g as m,v as c,i as v,p as U,j as A}from"./index-CWVWdIaL.js";import{a as q}from"./axios-Cm0UX6qg.js";import{u as z,a as f,c as _,F as T}from"./index.esm-BQ7r5GQE.js";import{u as Z}from"./token-Cfw4qG7q.js";import{n as G}from"./httputils-0tl6qC22.js";import{G as $}from"./loginStyle-ZE8PhNjk.js";const j=g=>(U("data-v-413e4f25"),g=g(),A(),g),C={class:"screen"},D=j(()=>l("h1",null,"Registrer ny bruker",-1)),M={class:"inputs"},L={key:0,class:"error"},H={key:1,class:"error"},J={key:2,class:"error"},K={key:3,class:"error"},O={key:4,class:"error"},Q={key:5,class:"error"},W={key:6,class:"error"},X=["disabled"],Y={__name:"RegisterView",setup(g){const{handleSubmit:V,errors:a,meta:b}=z(),E=Z(),N=P(""),h=P(""),x=/^[A-Za-z\s-]+$/,B=/^[a-zA-Z0-9._%+-æøåÆØÅ]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,{value:w}=f("firstName",_().required("Fornavn må fylles ut").matches(x,"Fornavn kan bare inneholde bokstaver")),{value:y}=f("lastName",_().required("Etternavn må fylles ut").matches(x,"Etternavn kan bare inneholde bokstaver")),{value:n}=f("email",_().required("Epost må fylles ut").matches(B,"Må være en gyldig epost")),{value:d}=f("password",_().required("Passord må oppgis")),{value:k}=f("confirmPassword",_().required("Passord må oppgis")),F=V(async()=>{try{if(d.value!==k.value){h.value="Passordene matcher ikke",console.error(h.value);return}const p=await q.post("http://localhost:8080/api/users",{firstName:w.value,lastName:y.value,email:n.value,password:d.value});console.log(p.data);const s=await q.post("http://localhost:8080/api/login",{email:n.value,password:d.value});console.log(s.data),E.saveEmailAndTokenInStore(n.value,s.data),await G("/config")}catch(p){p.response&&p.response.status===409&&(console.error("email already registered"),N.value="Eposten er allerede registrert",n.value=""),console.error("Login failed:",p)}});return(p,s)=>(r(),o("div",C,[S($,{page:"/",class:"goBackButton"}),D,S(e(T),{onSubmit:e(F)},{default:I(()=>[l("div",M,[e(a).firstName?(r(),o("span",L,i(e(a).firstName),1)):u("",!0),m(l("input",{type:"text",name:"firstName",placeholder:"Fornavn",class:"input","onUpdate:modelValue":s[0]||(s[0]=t=>v(w)?w.value=t:null),required:""},null,512),[[c,e(w)]]),e(a).lastName?(r(),o("span",H,i(e(a).lastName),1)):u("",!0),m(l("input",{type:"text",name:"lastName",placeholder:"Etternavn",class:"input","onUpdate:modelValue":s[1]||(s[1]=t=>v(y)?y.value=t:null),required:""},null,512),[[c,e(y)]]),e(a).email?(r(),o("span",J,i(e(a).email),1)):u("",!0),m(l("input",{type:"text",name:"email",placeholder:"E-post adresse",class:"input","onUpdate:modelValue":s[2]||(s[2]=t=>v(n)?n.value=t:null),required:""},null,512),[[c,e(n)]]),e(a).password?(r(),o("span",K,i(e(a).password),1)):u("",!0),m(l("input",{type:"password",name:"password",placeholder:"Passord",class:"input","onUpdate:modelValue":s[3]||(s[3]=t=>v(d)?d.value=t:null),required:""},null,512),[[c,e(d)]]),e(a).confirmPassword?(r(),o("span",O,i(e(a).confirmPassword),1)):u("",!0),m(l("input",{type:"password",name:"confirmPassword",placeholder:"Gjenta passord",class:"input","onUpdate:modelValue":s[4]||(s[4]=t=>v(k)?k.value=t:null),required:""},null,512),[[c,e(k)]]),N.value?(r(),o("div",Q,i(N.value),1)):u("",!0),h.value?(r(),o("div",W,i(h.value),1)):u("",!0)]),l("button",{class:"register",type:"submit",disabled:!e(b).valid||!e(b).dirty},"Registrer",8,X)]),_:1},8,["onSubmit"])]))}},le=R(Y,[["__scopeId","data-v-413e4f25"]]);export{le as default};
